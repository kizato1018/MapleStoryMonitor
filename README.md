# MapleStory 遊戲狀態監控程序使用說明

## 🎮 程序介紹

這是一個專為 MapleStory 遊戲設計的狀態監控程序，可以自動識別並監控遊戲中的：
- **HP（生命值）**：顯示當前生命值和最大生命值
- **MP（魔法值）**：顯示當前魔法值和最大魔法值  
- **EXP（經驗值）**：顯示當前經驗值百分比，並計算升級所需時間

程序使用光學字符識別(OCR)技術，通過截取遊戲畫面特定區域來自動讀取數值，無需修改遊戲檔案。

---

## 📋 目錄

1. [系統需求](#系統需求)
2. [Python 安裝教學](#python-安裝教學)
3. [程序下載與安裝](#程序下載與安裝)
4. [第一次使用設定](#第一次使用設定)
5. [如何使用程序](#如何使用程序)
6. [常見問題解決](#常見問題解決)
7. [進階設定](#進階設定)

---

## 💻 系統需求

### Windows 用戶
- **作業系統**：Windows 10 或更新版本
- **記憶體**：至少 4GB RAM
- **硬碟空間**：至少 1GB 可用空間
- **網路連線**：首次安裝時需要網路下載套件

### Mac 用戶
- **作業系統**：macOS 10.15 (Catalina) 或更新版本
- **記憶體**：至少 4GB RAM
- **硬碟空間**：至少 1GB 可用空間
- **網路連線**：首次安裝時需要網路下載套件
- **權限**：可能需要允許應用程式擷取螢幕畫面

---

## 🐍 Python 安裝教學

### 共通步驟：下載 Python

1. 打開瀏覽器（Chrome、Firefox、Safari、Edge 等）
2. 前往 Python 官方網站：https://www.python.org/downloads/
3. 點擊黃色的 "Download Python 3.x.x" 按鈕（x 代表版本號碼）
4. 等待下載完成

---

### Windows 用戶安裝步驟

#### 步驟 1：找到下載的檔案
- 通常在「下載」資料夾中
- 檔案名稱類似 `python-3.x.x-amd64.exe`

#### 步驟 2：開始安裝
1. **雙擊下載的檔案**
   - 如果出現安全提示，點擊「是」或「執行」

2. **重要設定**
   - ✅ **必須勾選** "Add Python to PATH" 
   - ✅ **必須勾選** "Install for all users"（如果有此選項）
   - 點擊 "Install Now"

3. **等待安裝完成**
   - 安裝過程約需 3-5 分鐘
   - 看到 "Setup was successful" 表示安裝成功

#### 步驟 3：驗證安裝（Windows）
1. **開啟命令提示字元**
   - 按下 `Windows鍵 + R`
   - 輸入 `cmd` 後按 Enter
   - 會開啟黑色視窗

2. **檢查 Python 版本**
   - 在黑色視窗中輸入：`python --version`
   - 按 Enter
   - 如果顯示 `Python 3.x.x` 表示安裝成功

3. **檢查 pip 工具**
   - 輸入：`pip --version`
   - 按 Enter
   - 如果顯示版本資訊表示正常

---

### Mac 用戶安裝步驟

#### 步驟 1：找到下載的檔案
- 通常在「下載項目」資料夾中
- 檔案名稱類似 `python-3.x.x-macos11.pkg`

#### 步驟 2：開始安裝
1. **雙擊下載的 .pkg 檔案**
   - 可能會顯示「無法打開，因為它來自未識別的開發者」
   - 如果出現此問題：
     - 右鍵點擊檔案 → 選擇「打開」
     - 在彈出視窗中點擊「打開」

2. **按照安裝精靈進行**
   - 點擊「繼續」
   - 閱讀授權條款，點擊「同意」
   - 選擇安裝位置（建議使用預設位置）
   - 點擊「安裝」

3. **輸入管理員密碼**
   - 系統會要求輸入您的 Mac 登入密碼
   - 輸入密碼後點擊「安裝軟體」

4. **等待安裝完成**
   - 安裝過程約需 3-5 分鐘
   - 看到「安裝成功」表示完成

#### 步驟 3：驗證安裝（Mac）
1. **開啟終端機**
   - 方法一：按下 `Command + 空白鍵`，輸入「終端機」或「Terminal」，按 Enter
   - 方法二：開啟「應用程式」→「工具程式」→「終端機」

2. **檢查 Python 版本**
   - 在終端機中輸入：`python3 --version`
   - 按 Enter
   - 如果顯示 `Python 3.x.x` 表示安裝成功

3. **檢查 pip 工具**
   - 輸入：`pip3 --version`
   - 按 Enter
   - 如果顯示版本資訊表示正常

4. **設置別名（可選，讓指令更簡單）**
   - 輸入：`echo 'alias python=python3' >> ~/.zshrc`
   - 輸入：`echo 'alias pip=pip3' >> ~/.zshrc`
   - 輸入：`source ~/.zshrc`
   - 之後就可以使用 `python` 和 `pip` 指令

---

## 📦 程序下載與安裝

### 🚀 自動安裝（推薦）

#### Windows 用戶

1. **下載程序檔案**
   - 下載完整的程序資料夾
   - 解壓縮到您想要的位置（如桌面）

2. **執行自動安裝**
   - 雙擊 `install.bat` 檔案
   - 或右鍵選擇「以系統管理員身分執行」
   - 按照螢幕指示完成安裝

3. **啟動程序**
   - 安裝完成後，雙擊 `run` 啟動程序

#### Mac 用戶

1. **下載程序檔案**
   - 下載完整的程序資料夾
   - 解壓縮到您想要的位置（如桌面）

2. **執行自動安裝**
   - 開啟終端機
   - 切換到程序資料夾：`cd ~/Desktop/MapleStoryMonitor`
   - 執行安裝腳本：`chmod +x install.sh && ./install.sh`
   - 按照螢幕指示完成安裝

3. **啟動程序**
   - 安裝完成後，執行：`./run.sh`
   - 或雙擊 `run.sh` 檔案

---

### 📁 手動安裝（進階用戶）

#### 方法一：下載 ZIP 檔案（建議新手使用）

1. **下載程序檔案**
   - 聯絡程序提供者獲取最新版本的 ZIP 檔案
   - 或從指定位置下載 `MapleStoryMonitor.zip`

2. **解壓縮檔案**
   - 在下載的 ZIP 檔案上按右鍵
   - 選擇「解壓縮至此處」或「Extract Here」
   - 會產生一個 `MapleStoryMonitor` 資料夾

3. **放置程序**
   - 將解壓縮的資料夾移動到您想要的位置
   - 建議放在桌面或 `C:\Program Files\` 底下

#### 方法二：Git 下載（進階用戶）

如果您熟悉 Git，可以執行：
```bash
git clone [repository_url] MapleStoryMonitor
cd MapleStoryMonitor
```

---

## 🛠️ 手動設定（僅在自動安裝失敗時使用）

### 步驟 1：安裝必要套件

#### Windows 用戶

1. **開啟命令提示字元**
   - 按下 `Windows鍵 + R`
   - 輸入 `cmd` 後按 Enter

2. **切換到程序資料夾**
   - 假設您將程序放在桌面，輸入：
   ```
   cd Desktop\MapleStoryMonitor
   ```

3. **安裝相依套件**
   - 輸入以下指令並按 Enter：
   ```
   pip install -r requirements.txt
   ```
   - 等待安裝完成（可能需要 5-15 分鐘）
   - 如果出現紅色錯誤訊息，請參考[常見問題](#常見問題解決)

#### Mac 用戶

1. **開啟終端機**
   - 按下 `Command + 空白鍵`，輸入「終端機」或「Terminal」，按 Enter
   - 或開啟「應用程式」→「工具程式」→「終端機」

2. **切換到程序資料夾**
   - 假設您將程序放在桌面，輸入：
   ```
   cd ~/Desktop/MapleStoryMonitor
   ```

3. **安裝相依套件**
   - 輸入以下指令並按 Enter：
   ```
   pip3 install -r requirements.txt
   ```
   - 如果您之前設置了別名，也可以使用：
   ```
   pip install -r requirements.txt
   ```
   - 等待安裝完成（可能需要 5-15 分鐘）
   - 如果出現錯誤訊息，請參考[常見問題](#常見問題解決)

### 步驟 2：首次啟動程序

#### Windows 用戶

1. **執行程序**
   - 在命令提示字元中輸入：
   ```
   python main.py
   ```
   - 或者雙擊 `main.py` 檔案

#### Mac 用戶

1. **執行程序**
   - 在終端機中輸入：
   ```
   python3 main.py
   ```
   - 如果您設置了別名，也可以使用：
   ```
   python main.py
   ```

### 程序介面說明

不管是Windows還是Mac用戶，程序啟動後會開啟一個視窗，包含以下標籤頁：
- **總覽**：顯示所有監控數值
- **HP**：生命值監控
- **MP**：魔法值監控  
- **EXP**：經驗值監控
- **設定**：視窗選擇和全域設定

---

## 🎯 如何使用程序

### 第一步：設定目標視窗

1. **開啟 MapleStory 遊戲**
   - 確保遊戲正常運行
   - 進入遊戲主畫面（可以看到 HP/MP/EXP 數值）

2. **在監控程序中選擇視窗**
   - 點擊「設定」標籤頁
   - 在「目標視窗選擇」區域
   - 點擊「搜尋視窗」按鈕
   - 從列表中選擇 MapleStory 視窗
   - 或在搜尋框中輸入 "MapleStory" 後點擊「自動搜尋」

### 第二步：設定監控區域

#### 設定 HP 監控區域

1. **切換到 HP 標籤頁**
2. **設定捕捉區域**
   - 方法一（自動設定）：點擊「自動」按鈕，會自動設定為遊戲視窗大小
   - 方法二（手動選擇）：
     - 點擊「滑鼠選擇」按鈕
     - 在遊戲中 HP 顯示區域拖拉選擇範圍
     - 確保選中的區域包含 HP 數值（例如：[1234/5678]）
     - 按 Enter 確認或 Esc 取消

3. **調整區域參數（可選）**
   - 可以直接修改 X、Y、W、H 數值來精確調整區域
   - X：水平位置，Y：垂直位置，W：寬度，H：高度

#### 設定 MP 和 EXP 監控區域

重複上述步驟分別設定 MP 和 EXP 的監控區域。

### 第三步：調整設定

1. **設定擷取頻率**
   - 在「設定」標籤頁中調整「擷取頻率 (FPS)」
   - 建議值：1.0-2.0（數值越高更新越快，但佔用更多資源）


### 第四步：開始監控

1. **檢查預覽**
   - 在各個標籤頁中查看右側預覽畫面
   - 確認能正確捕捉到數值區域

2. **查看識別結果**
   - 在「辨識結果」框中查看 OCR 識別出的文字
   - 正常情況下會顯示類似 "[1234/5678]" 的格式

3. **監控總覽**
   - 切換到「總覽」標籤頁
   - 查看所有數值的即時顯示

---

## ❗ 常見問題解決

### 安裝問題

**Q: 安裝套件時出現 "pip is not recognized" 錯誤**

A: Python 安裝時沒有正確設定環境變數
- 重新安裝 Python，確保勾選 "Add Python to PATH"
- 或手動添加 Python 到系統環境變數

**Q: 安裝 requirements.txt 時出現權限錯誤**

A: 以管理員身份執行
- 在開始選單搜尋 "cmd"
- 右鍵點選「以系統管理員身分執行」
- 重新執行安裝指令

**Q: easyocr 安裝失敗**

A: 網路連線或儲存空間問題
- 確保網路連線正常
- 確保有足夠的硬碟空間（至少 1GB）
- 嘗試分步安裝：`pip install easyocr`

### 使用問題

**Q: 找不到 MapleStory 視窗**

A: 確認遊戲狀態
- 確保 MapleStory 遊戲正在運行
- 確保遊戲視窗沒有被最小化
- 嘗試切換遊戲視窗後重新搜尋

**Q: OCR 識別結果不正確**

A: 調整設定和區域
- 確認選擇的區域只包含數值，不包含其他圖像
- 嘗試調整區域大小，使數值更清楚
- 檢查遊戲畫質設定，建議使用較高解析度

**Q: 程序運行緩慢**

A: 降低擷取頻率
- 將 FPS 設定降低到 0.5-1.0
- 關閉其他不必要的程序
- 確保電腦效能足夠

**Q: HP/MP 顯示 "N/A"**

A: 檢查區域設定
- 確認選擇的區域包含完整的 HP/MP 數值
- 檢查遊戲中 HP/MP 是否以標準格式顯示（例如：[1234/5678]）
- 嘗試重新設定監控區域

---

## ⚙️ 進階設定

### 重新安裝程序

如果遇到問題需要重新安裝：

#### Windows
```batch
# 刪除虛擬環境
rmdir /s venv
# 重新執行安裝
install.bat
```

#### Mac
```bash
# 刪除虛擬環境
rm -rf venv
# 重新執行安裝
./install.sh
```

### 手動更新套件

在虛擬環境中更新套件：

#### Windows
```batch
call venv\Scripts\activate.bat
pip install --upgrade -r requirements.txt
```

#### Mac
```bash
source venv/bin/activate
pip install --upgrade -r requirements.txt
```

---

## 🔧 技術支援

### 系統需求檢查

執行以下指令檢查系統環境：

```bash
# 檢查 Python 版本
python --version

# 檢查已安裝套件
pip list

# 檢查系統資訊
systeminfo
```

### 重新安裝套件

如果遇到套件問題，可以重新安裝：

```bash
# 清除快取
pip cache purge

# 重新安裝
pip uninstall -r requirements.txt -y
pip install -r requirements.txt
```

---

## ❓ 聯絡支援

如果按照本說明操作仍有問題，請提供以下資訊：

1. **作業系統版本**：Windows 10/11
2. **Python 版本**：執行 `python --version` 的結果
3. **錯誤訊息**：完整的錯誤訊息截圖或文字
4. **操作步驟**：詳細描述您進行的操作
5. **Log 檔案**：`Log/game_monitor.log` 的內容

---

## 📄 授權聲明

本程序僅供個人學習和研究使用，請遵守遊戲條款和相關法律法規。

---

**祝您遊戲愉快！** 🎮✨